<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Guess Game Demo</title>
    <link rel="stylesheet" href="css/styles.css" media="screen" title="no title" charset="utf-8">
  </head>
  <body>
    <div class="header">
      <h1 class="sub-heading">Taylor's Guessing Game</h1>
    </div>

    <div class="push">
      <!-- this is empty to compensate for the header -->
    </div>

    <div>
      <h1 class="" id="userName"></h1>
    </div>

    <div>
      <h1 class="" id="question"> </h1>
      <h2 class="" id="answer"> </h2>
    </div>

    <div>
      <form action="" id="userAnswerForm" class="form-field">
        <input type="text" class="txt-field-style" name="userAnswer" id="userAnswer" placeholder="Put Your Answer Here"><br />
        <input type="button" class="btn-style" id="userSubmitButton" onclick = "onSubmitAnswer()" value="Submit Answer">
        <input type="button" class="btn-style" id="nextQuestionButton" onclick = "displayNextQuestion()" value="Next Question" style="display:none">
      </form>
    </div>

    <script type="text/javascript">
      var userName, answer = '';
      var currentQuestion;

      //udpates page with text
      var displayOnPage = function(elmId,msg){
        document.getElementById(elmId).innerHTML = msg;
      };

      //grabs the users answer and then checks value.
      var onSubmitAnswer = function(event){
        answer = document.getElementById('userAnswer').value;
        console.log("The answer from button submit " + answer);

        userName = userName || answer; // assign the user name if it is undefined.
        game.currentQuestion.checkAnswer(answer);
        showNextButton();
      };

      var displayNextQuestion = function(event){
        game.nextQuestion(); //show next question
        game.clearAnswer(); //clear previous answer
        showSubmitButton();
      };

      var showSubmitButton = function() {
        document.getElementById('userSubmitButton').style.display = "inline-block";
        document.getElementById('userAnswer').style.display= "inline-block";
        document.getElementById('nextQuestionButton').style.display = "none";
      };

      var showNextButton = function() {
        document.getElementById('nextQuestionButton').style.display = "inline-block";
        document.getElementById('userSubmitButton').style.display = "none";
        document.getElementById('userAnswer').value = ""; //clear the input field
        document.getElementById('userAnswer').style.display = "none";
      };

      // ask for the users name
      // userName = prompt("Enter your name");
      // displayOnPage('userName', "Hi " + userName + ". Let's play a game.");

      console.log("This is the userName var: " + userName);

      //questions all have the same, repetitive properties. Lets build an object.
      var Question = function(question, answer, correctMsg, incorrectMsg){
        this.question = question;
        this.answer = answer;
        this.correctMsg = correctMsg;
        this.incorrectMsg = incorrectMsg;
      };

      Question.prototype.checkAnswer = function(userAnswer){
        console.log("The answer is: " + this.answer);
        if (answer.toLowerCase() === this.answer){
            displayOnPage('answer', this.correctMsg);
          } else {
            displayOnPage('answer', this.incorrectMsg);
          }
        };

      Question.prototype.displayQuestion = function () {
        displayOnPage('question', this.question);
      };

      //lets make a Game
      var Game = function(questions) {
        this.questions = questions;
        this.questionIdx = 0;
        this.currentQuestion = questions[0];
        this.questionLength = questions.length;
      };

      Game.prototype.nextQuestion = function () {
        if (this.questionIdx < this.questionLength - 1){
          this.questionIdx++;
          this.currentQuestion = this.questions[this.questionIdx];
          this.currentQuestion.displayQuestion();
        } else {
          displayOnPage('question', "Nice work, you're finished.");
        }
      };

      Game.prototype.clearAnswer = function () {
        displayOnPage('answer', "");
      };

      var questionOne = new Question(
        "Did I grow up in the Seattle area?",
        "yes",
        "Good Job, " + userName + "! I did grow up in the area.",
        "I'm sorry " + userName + ", but I did indeed grow up in the area."
      );

      var questionTwo = new Question(
        "Have I ever visited Africa?",
        "no",
        "Good Job, " + userName + "! I have never visited Africa.",
        "I'm sorry " + userName + ", but I have never been to Africa."
      );

      var questionThree = new Question(
        "Do I own an 80lb German Shepherd / Husky dog?",
        "yes",
        "Good Job, " + userName + "! I do have a huge German Shepherd / Husky dog.",
        "I'm sorry " + userName + ", but I do indeed own a huge German Shepherd / Husky dog."
      );

      var questionFour = new Question(
        // this is a tricky one
        "Try to guess the number. It is between 1 and 10.",
        Math.floor(Math.random() * (10 - 1)) + 1, //took this from MDN
        "Good Job, " + userName + "! You got it right!",
        "" // we will use our new CheckAnswer() to generate this...
      );

      // These next two 'questions' have been really bastardized. We need custom
      // checkAnswer() so we overrite the prototype.

      questionFour.checkAnswer = function(answer) {
        // questionFour needs a new checkAnswer() to account for the
        // answer being too high or too low
        console.log("The correctNum var is: " + this.answer);

        if (parseInt(answer) === this.answer) {
          displayOnPage('answer', this.correctMsg);
        } else if (parseInt(answer) > this.answer) {
          displayOnPage('answer', "Oops! Too high.");
        } else {
          displayOnPage('answer', "Oops! Too low.");
        }
      };

      var nameQuestion = new Question(
        "What is your name?",
        true,
        "Hi " + userName + ". Let's play a game.",
        "" // there is no incorrect answer
      );

      nameQuestion.checkAnswer = function(answer) {
        // we just want to display the name
        console.log("The user's name is: " + answer);
        displayOnPage('userName', "Hi " + userName + ". Let's play a game.");
      };

      var questions = [nameQuestion, questionOne, questionTwo, questionThree, questionFour];
      var game = new Game(questions);

      var initGame = function(){
        //starts the game.
        game.currentQuestion.displayQuestion();
      };

      initGame();
    </script>
  </body>
</html>
